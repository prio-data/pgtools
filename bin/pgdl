#! /usr/bin/env python

import fire
from pgtools.remote import getvar 
from pgtools.util import writecsv

FORMATS = {
   "long": (lambda x: x, writecsv) 
}

def main(vname,out,format=None):
   if format is None:
      format = "long"

   converter,writer = FORMATS[format]

   data = getvar(vname)
   data = converter(data)
   writer(data,out)

if __name__ == "__main__":
   fire.Fire(main)
